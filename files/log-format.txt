{ 
    "timestamp": "%{strftime(\{"%Y-%m-%dT%H:%M:%S"\}, time.start)}V", 
    "client_ip": "%{req.http.Fastly-Client-IP}V", 
    "host": "%{if(req.http.Fastly-Orig-Host, req.http.Fastly-Orig-Host, req.http.Host)}V", 
    "url": "%{json.escape(req.url)}V", 
    "request_method": "%{json.escape(req.method)}V", 
    "response_state": "%{json.escape(fastly_info.state)}V", 
    "response_status": %{resp.status}V, 
    "response_reason": %{if(resp.response, "%22"+json.escape(resp.response)+"%22", "null")}V, 
    "fastly_server": "%{json.escape(server.identity)}V", 
    "fastly_is_edge": %{if(fastly.ff.visits_this_service == 0, "true", "false")}V, 
    "edge_rate_limited": %{if(resp.status == 429, "true", "false")}V, 
    "pageview_count_10s": %{ratecounter.rc_external_logins.bucket.10s}V, 
    "pageview_count_20s": %{ratecounter.rc_external_logins.bucket.20s}V, 
    "pageview_count_30s": %{ratecounter.rc_external_logins.bucket.30s}V, 
    "pageview_count_40s": %{ratecounter.rc_external_logins.bucket.40s}V, 
    "pageview_count_50s": %{ratecounter.rc_external_logins.bucket.50s}V, 
    "pageview_count_60s": %{ratecounter.rc_external_logins.bucket.60s}V, 
    "fastly_vcl_version": %{req.vcl.version}V
}